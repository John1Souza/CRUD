<div class="transacoes">
  <div class="botoes-transacoes">
    <div
      class="botoes-transacoes-items"
      *ngFor="let item of tipos"
      (click)="toggleDisplay()"
    >
      <img [src]="getIconPath(item)" />
      <button>
        Nova {{item}}
      </button >
    </div>
  </div>
  <table class="tabela-transacoes">
    <tr class="cabecalho">
      <td>Tipo</td>
      <td>Valor</td>
      <td>Categoria</td>
      <td>Descricao</td>
      <td>Editar/Excluir</td>
    </tr>
    <tr *ngFor="let transacao of transacoes">
      <td>{{ transacao.tipo }}</td>
      <td>{{ transacao.valor | currency }}</td>
      <td>{{ transacao.tipo_transacao_id }}</td>
      <td>{{ transacao.descricao }}</td>
      <td id="botoes">
        <button id="editar" (click)="editarTransacao(transacao)">Editar</button>
        <button id="excluir" (click)="excluir(transacao.id)">Excluir</button>
      </td>
    </tr>
  </table>

  <!-- Formulário de edição inline -->
  <div *ngIf="transacaoEditando">
    <h3>Editar Transação</h3>
    <form [formGroup]="transacaoForm" (ngSubmit)="salvarEdicao()">
      <div>
        <label for="descricao">Descrição:</label>
        <input id="descricao" formControlName="descricao" />
      </div>

      <div>
        <label for="valor">Valor:</label>
        <input id="valor" type="number" formControlName="valor" />
      </div>

      <div>
        <label>Tipo:</label>
        <label>
          <input type="radio" formControlName="tipo" value="receita" /> Receita
        </label>
        <label>
          <input type="radio" formControlName="tipo" value="despesa" /> Despesa
        </label>
      </div>

      <div>
        <label for="tipo_transacao_id">Categoria:</label>
        <select id="tipo_transacao_id" formControlName="tipo_transacao_id">
          <option *ngFor="let tipo of tipoTransacoes" [value]="tipo.id">
            {{ tipo.nome }}
          </option>
        </select>
      </div>

      <button type="submit">Salvar</button>
      <button type="button" (click)="cancelarEdicao()">Cancelar</button>
    </form>
  </div>

  <form [formGroup]="meuFormulario" (ngSubmit)="onSubmit()" [ngStyle]="{'display': isVisible ? 'flex' : 'none'}" class="formulario-transacao">
    <!-- -->
    <div>
      <label for="tipo">Tipo:</label><br>
      <select id="tipo" name="tipo" formControlName="tipo">
          <option *ngFor="let tipo of tipos" [value]="tipo">
            {{ tipo === 'receita' ? 'Receita' : 'Despesa' }}
          </option>
      </select>
    </div>
    <div>
      <label for="tipo_transacao_id">Categoria:</label>
      <select id="tipo_transacao_id" formControlName="tipo_transacao_id" required>
        <option value="" disabled selected>--Selecione uma categoria--</option>
        <option *ngFor="let categoria of tipoTransacoes" [value]="categoria.id">
            {{ categoria.nome }}
        </option>
      </select>
    </div>
    <div >
      <label for="valor">Valor:</label><br>
      <input type="number" id="valor" name="valor" formControlName="valor">
    </div>
    <div>
      <label for="descricao">Descrição:</label><br>
      <textarea type="text" id="descricao" name="descricao" formControlName="descricao"></textarea>
    </div>
    <button id="criar" type="submit" [disabled]="meuFormulario.invalid">Criar</button>
    <!-- <button id="criar" type="submit">{{ isEditMode ? 'Salvar Alterações' : 'Criar' }}</button> -->
  </form>
</div>
